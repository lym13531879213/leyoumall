<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.mall.operator.mapper.PmsAttrMapper">
    <select id="getAttrPage" resultType="cn.com.mall.entity.PmsAttr">
        select attr_id,
               attr_name,
               search_type,
               value_type,
               icon,
               value_select,
               attr_type,
               `enable`,
               catelog_id,
               cateIds,
               show_desc,
               create_time,
               update_time
        from leyoumall.pms_attr
        <where>
            <if test="attrId != null">
                attr_id = #{attrId}
            </if>
            <if test="attrName != null and attrName != ''">
                and attr_name like concat('%', #{attrName}, '%')
            </if>
            <if test="attrType != null">
                and attr_type = #{attrType}
            </if>
            <if test="enable != null">
                and enable = #{enable}
            </if>
            <if test="searchType != null">
                and search_type = #{searchType}
            </if>
        </where>
    </select>

    <select id="getById" resultType="cn.com.mall.entity.PmsAttr">
        select attr_id,
               attr_name,
               search_type,
               icon,
               value_type,
               value_select,
               attr_type,
               `enable`,
               cateIds,
               catelog_id,
               show_desc,
               create_time,
               update_time
        from leyoumall.pms_attr
        where attr_id = #{attrId}
    </select>

    <insert id="addAttr" parameterType="cn.com.mall.operator.pojo.dto.pms.AttrDTO">
        insert into leyoumall.pms_attr(attr_name, search_type, value_type, value_select, attr_type, enable, catelog_id,
                                       cateIds,
                                       show_desc, create_time, update_time)
        VALUES (#{attrName}, #{searchType}, #{valueType}, #{valueSelect}, #{attrType}, #{enable}, #{catId}, #{cateIds},
                #{showDesc}, now(), now())
    </insert>

    <update id="putAttr">
        update leyoumall.pms_attr
        set attr_name    = #{attrName},
            value_type   = #{valueType},
            value_select = #{valueSelect},
            attr_type    = #{attrType},
            catelog_id   = #{catId},
            cateIds      = #{cateIds},
            update_time  = now()
        where attr_id = #{attrId}
    </update>
</mapper>